<p>This tool calculates the most elevation percentile (EP) across a range of spatial scales. EP is a measure of local topographic position (LTP) and expresses the vertical position for a digital elevation model (DEM) grid cell (z<sub>0</sub>) as the percentile of the elevation distribution within the filter window, such that:</p> <blockquote> <p>EP = count<sub>i&isin;C</sub>(z<sub>i</sub> &gt; z<sub>0</sub>) x (100 / n<sub>C</sub>)</p> </blockquote> <p>where z<sub>0</sub> is the elevation of the window's center grid cell, z<sub>i</sub> is the elevation of cell <em>i</em> contained within the neighboring set C, and n<sub>C</sub> is the number of grid cells contained within the window.</p> <p>EP is unsigned and expressed as a percentage, bound between 0% and 100%. This tool outputs two rasters, the multiscale EP magnitude (<code>out_mag</code>) and the scale at which the most extreme EP value occurs (<code>out_scale</code>). <strong>The magnitude raster is the most extreme EP value (i.e. the furthest from 50%) for each grid cell encountered within the tested scales of EP.</strong></p> <p>Quantile-based estimates (e.g., the median and interquartile range) are often used in nonparametric statistics to provide data variability estimates without assuming the distribution is normal. Thus, EP is largely unaffected by irregularly shaped elevation frequency distributions or by outliers in the DEM, resulting in a highly robust metric of LTP. In fact, elevation distributions within small to medium sized neighborhoods often exhibit skewed, multimodal, and non-Gaussian distributions, where the occurrence of elevation errors can often result in distribution outliers. Thus, based on these statistical characteristics, EP is considered one of the most robust representation of LTP.</p> <p>The algorithm implemented by this tool uses the relatively efficient running-histogram filtering algorithm of Huang et al. (1979). Because most DEMs contain floating point data, elevation values must be rounded to be binned. The <code>sig_digits</code> parameter is used to determine the level of precision preserved during this binning process. The algorithm is parallelized to further aid with computational efficiency.</p> <p>Experience with multiscale EP has shown that it is highly variable at shorter scales and changes more gradually at broader scales. Therefore, a nonlinear scale sampling interval is used by this tool to ensure that the scale sampling density is higher for short scale ranges and coarser at longer tested scales, such that:</p> <blockquote> <p><em>r<sub>i</sub></em> = <em>r<sub>L</sub></em> + [step &times; (i - <em>r<sub>L</sub></em>)]<sup><em>p</em></sup></p> </blockquote> <p>Where <em>ri</em> is the filter radius for step <em>i</em> and <em>p</em> is the nonlinear scaling factor (<code>step_nonlinearity</code>) and a step size (<code>step</code>) of <em>step</em>.</p> <h2>References</h2> <p>Newman, D. R., Lindsay, J. B., and Cockburn, J. M. H. (2018). Evaluating metrics of local topographic position for multiscale geomorphometric analysis. Geomorphology, 312, 40-50.</p> <p>Huang, T., Yang, G.J.T.G.Y. and Tang, G., 1979. A fast two-dimensional median filtering algorithm. IEEE Transactions on Acoustics, Speech, and Signal Processing, 27(1), pp.13-18.</p> <h2>See Also</h2> <p><a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#elevation_percentile">elevation_percentile</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#max_elevation_deviation">max_elevation_deviation</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#max_difference_from_mean">max_difference_from_mean</a></p> <h2>Function Signature</h2> <p><code>def multiscale_elevation_percentile(self, dem: Raster, num_significant_digits: int = 3, min_scale: int = 4, step_size: int = 1, num_steps: int = 10, step_nonlinearity: float = 1.0) -&gt; Tuple[Raster, Raster]: ... </code></p>
<h2>Project Links</h2>
<div align="left">
    <a href="https://www.whiteboxgeo.com/whitebox-workflows-for-python/">WbW Homepage</a>
    <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/preface.html">User Manual</a>
    <a href="https://www.whiteboxgeo.com/wbw-purchase/">Support WbW</a>
</div>        
