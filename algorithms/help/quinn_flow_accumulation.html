<p>This tool is used to generate a flow accumulation grid (i.e. contributing area) using the Quinn et al. (1995)  flow algorithm, sometimes called QMFD or QMFD2, and not to be confused with the similarly named <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#qin_flow_accumulation">qin_flow_accumulation</a> tool. This algorithm is an examples of a multiple-flow-direction (MFD) method because the flow entering each grid cell is routed to more than one downslope neighbour, i.e. flow <em>divergence</em> is permitted. The user must specify the name (<code>dem</code>) of the input digital elevation model (DEM). The DEM must have been hydrologically corrected to remove all spurious depressions and flat areas. DEM pre-processing is usually achieved using either the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#breach_depressions_least_cost">breach_depressions_least_cost</a> (also <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#breach_depressions_least_cost">breach_depressions_least_cost</a>) or <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#fill_depressions">fill_depressions</a> tool. A value must also be specified for the exponent parameter (<code>exponent</code>), a number that controls the degree of dispersion in the resulting flow-accumulation grid. A lower value yields greater apparent flow dispersion across divergent hillslopes. The exponent value (<em>h</em>) should probably be less than 50.0, as higher values may cause numerical instability, and values between 1 and 2 are most common.  The following equations are used to calculate the portion flow (<em>F<sub>i</sub></em>) given to each neighbour, <em>i</em>:</p> <blockquote> <p><em>F<sub>i</sub></em> = <em>L<sub>i</sub></em>(tan&beta;)<sup><em>p</em></sup> / &Sigma;<sub><em>i</em>=1</sub><sup><em>n</em></sup>[<em>L<sub>i</sub></em>(tan&beta;)<sup><em>p</em></sup>]</p> <p><em>p</em> = (<em>A</em> / <em>threshold</em> + 1)<sup><em>h</em></sup></p> </blockquote> <p>Where <em>L<sub>i</sub></em> is the contour length, and is 0.5&times;cell size for cardinal directions and 0.354&times;cell size for diagonal directions, <em>n</em> = 8, and represents each of the eight neighbouring grid cells, and, <em>A</em> is the flow accumulation value assigned to the current grid cell, that is being  apportioned downslope. The non-dispersive, channel initiation <em>threshold</em> (<code>threshold</code>) is a flow-accumulation  value (measured in upslope grid cells, which is directly proportional to area) above which flow dispersion is  no longer permitted. Grid cells with flow-accumulation values above this threshold will have their flow routed  in a manner that is similar to the D8 single-flow-direction algorithm, directing all flow towards the steepest  downslope neighbour. This is usually done under the assumption that flow dispersion, whilst appropriate on  hillslope areas, is not realistic once flow becomes channelized. Importantly, the <code>threshold</code> parameter sets  the spatial extent of the stream network, with lower values resulting in more extensive networks. </p> <p>In addition to the input DEM, output file (<code>output</code>), and exponent, the user must also specify the output type (<code>out_type</code>). The output flow-accumulation can be: 1) <code>cells</code> (i.e. the number of inflowing grid cells), <code>catchment area</code> (i.e. the upslope area), or <code>specific contributing area</code> (i.e. the catchment area divided by the flow width). The default value is <code>specific contributing area</code>. The user must also specify whether the output flow-accumulation grid should be log-transformed (<code>log</code>), i.e. the output, if this option is selected, will be the natural-logarithm of the accumulated flow value. This is a transformation that is often performed to better visualize the contributing area distribution. Because contributing areas tend to be very high along valley bottoms and relatively low on hillslopes, when a flow-accumulation image is displayed, the distribution of values on hillslopes tends to be 'washed out' because the palette is stretched out to represent the highest values. Log-transformation provides a means of compensating for this phenomenon. Importantly, however, log-transformed flow-accumulation grids must not be used to estimate other secondary terrain indices, such as the wetness index (<a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#wetness_index">wetness_index</a>), or relative stream power index (<code>StreamPowerIndex</code>). The Quinn et al. (1995) algorithm is commonly used to calculate wetness index.</p> <h2>Reference</h2> <p>Quinn, P. F., K. J. Beven, Lamb, R. 1995. The in (a/tanÎ²) index: How to calculate it and how to use it within  the topmodel framework. <em>Hydrological Processes</em> 9(2): 161-182.</p> <h2>See Also</h2> <p><code>D8FlowAccumulation</code>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#qin_flow_accumulation">qin_flow_accumulation</a>, <code>FD8FlowAccumulation</code>, <code>DInfFlowAccumulation</code>, <code>MDInfFlowAccumulation</code>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#rho8_pointer">rho8_pointer</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#wetness_index">wetness_index</a></p> <h2>Function Signature</h2> <p><code>def quinn_flow_accumulation(self, dem: Raster, out_type: str = "sca", exponent: float = 1.1, convergence_threshold: float = float('inf'), log_transform: bool = False, clip: bool = False) -&gt; Raster: ... </code></p>
<h2>Project Links</h2>
<div align="left">
    <a href="https://www.whiteboxgeo.com/whitebox-workflows-for-python/">WbW Homepage</a>
    <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/preface.html">User Manual</a>
    <a href="https://www.whiteboxgeo.com/wbw-purchase/">Support WbW</a>
</div>        
