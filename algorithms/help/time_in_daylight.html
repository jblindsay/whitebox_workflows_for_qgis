<p>This tool calculates the proportion of time a location is within daylight. That is, it calculates the proportion of time, during a user-defined time frame, that a grid cell in an input digital elevation model (<code>dem</code>) is outside of an area of shadow cast by a local object. The input DEM should truly be a digital surface model (DSM) that contains significant off-terrain objects. Such a model, for example, could be created using the first-return points of a LiDAR data set, or using the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_digital_surface_model">lidar_digital_surface_model</a> tool.</p> <p>The tool operates by calculating a solar almanac, which estimates the sun's position for the location, in latitude and longitude coordinate (<code>lat</code>, <code>long</code>), of the input DSM. The algorithm then calculates horizon angle (see <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#horizon_angle">horizon_angle</a>) rasters from the DSM based on the user-specified azimuth fraction (<code>az_fraction</code>). For example, if an azimuth fraction of 15-degrees is specified, horizon angle rasters could be calculated for the solar azimuths 0, 15, 30, 45... In reality, horizon angle rasters are only calculated for azimuths for which the sun is above the horizon for some time during the tested time period. A horizon angle raster evaluates the vertical angle between each grid cell in a DSM and a distant obstacle (e.g. a mountain ridge, building, tree, etc.) that blocks the view along a specified direction. In calculating horizon angle, the user must specify the maximum search distance (<code>max_dist</code>) beyond which the query for higher, more distant objects will cease. This parameter strongly impacts the performance of the tool, with larger values resulting in significantly longer run-times. Users are advised to set the <code>max_dist</code> based on the maximum shadow length expected in an area. For example, in a relatively flat urban landscape, the tallest building will likely determine the longest shadow lengths. All grid cells for which the calculated solar positions throughout the time frame are higher than the cell's horizon angle are deemed to be illuminated during the time the sun is in the corresponding azimuth fraction.</p> <p>By default, the tool calculates time-in-daylight for a time-frame spanning an entire year. That is, the solar almanac is calculated for each hour, at 10-second intervals, and for each day of the year. Users may alternatively restrict the time of year over which time-in-daylight is calculated by specifying a starting day (1-365; <code>start_day</code>) and ending day (1-365; <code>end_day</code>). Similarly, by specifying start time (<code>start_time</code>) and end time (<code>end_time</code>) parameters, the user is able to measure time-in-daylight for specific ranges of the day (e.g. for the morning or afternoon hours). These time parameters must be specified in 24-hour time (HH:MM:SS), e.g. 15:30:00. <code>sunrise</code> and <code>sunset</code> are also acceptable inputs for the start time and end time respectively. The timing of sunrise and sunset on each day in the tested time-frame will be determined using the solar almanac.</p> <p><img alt="" src="./img/TimeInDaylight.png" /></p> <h2>See Also</h2> <p><a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_digital_surface_model">lidar_digital_surface_model</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#horizon_angle">horizon_angle</a></p> <h2>Function Signature</h2> <p><code>def time_in_daylight(self, dem: Raster, az_fraction: float = 5.0, max_dist: float = float('inf'), latitude: float = 0.0, longitude: float = 0.0, utc_offset_str: str = "UTC+00:00", start_day: int = 1, end_day: int = 365, start_time: str = "sunrise", end_time: str = "sunset") -&gt; Raster: ... </code></p>
<h2>Project Links</h2>
<div align="left">
    <a href="https://www.whiteboxgeo.com/whitebox-workflows-for-python/">WbW Homepage</a>
    <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/preface.html">User Manual</a>
    <a href="https://www.whiteboxgeo.com/wbw-purchase/">Support WbW</a>
</div>        
