<h2>License Information</h2> <p>Use of this function requires a license for Whitebox Workflows for Python Professional (WbW-Pro). Please visit <a href="https://www.whiteboxgeo.com/">www.whiteboxgeo.com</a> to purchase a license.</p> <p><strong>Theory</strong></p> <p>This tool calculates two indices related to hydrologic connectivity within catchments, the <em>downslope unsaturated length</em> (DUL) and the <em>upslope disconnected saturated area</em> (UDSA). Both of these hydrologic indices are based on the topographic wetness index (<a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#wetness_index">wetness_index</a>), which measures the propensity for a site to be saturated to the surface, and therefore, to contribute to surface runoff. The <a href="https://en.wikipedia.org/wiki/Topographic_wetness_index">wetness index</a> (WI) is commonly used in hydrologic modelling, and famously in the TOPMODEL, to simulate variable source area (VSA) dynamics within catchments. The VSA is a dynamic region of surface-saturated soils within catchments that contributes fast overland flow to downslope streams during periods of precipitation. As a catchment's soil saturation deficit decreases ('wetting up'), areas with increasingly lower WI values become saturated to the surface. That is, areas of high WI are the first to become saturated and as the moisture deficit decreases, lower WI-valued cells become saturated, increasing the spatial extent of the source area. As a catchment dries out, the opposite effect occurs. The distribution of WI can therefore be used to map the spatial dyanamics of the VSA. However, the assumption in the TOPMODEL is that any rainfall over surface saturated areas will contribute to fast overland flow pathways and to stream discharge within the time step.</p> <p>This method therefore implicitly assumes that all surface saturated grid cells are connected by continuously saturated areas along the downslope flow path connecting the cells to the stream. By comparison, Lane et al. (2004) proposed a modified WI, known as the network index (NI), which allowed for the modelling of disconnected, non-contributing saturated areas. The NI is essentially the downslope minimum WI. Grid cells for which WI &gt; NI are likely to be disconnected during certain conditions from downslope streams, while similarly WI-valued cells are contributing. During these periods, any surface runoff from these cells is likely to contribute to downslope re-infilitration rather than directly to stream discharge via overland flow. This has implications for the timing and quality of stream discharge.</p> <p>The DUL and UDSA indices extend the notion of the NI by mapping areas within catchments that are likely, at least during certain periods, to be sites of disconnected, non-contributing saturated areas and sites of re-infiltation respectively. These combined indices allow hydrologists to study the hydrologic connectivity and disconnectivity among areas within catchments.</p> <blockquote> <p>The DUL (see image below) is defined for a grid cell as <strong>the number of downslope cells with a WI value lower than the current cell</strong>. Areas with non-zero DUL are likely to become fully saturated, and to contribute to overland flow, before they are directly connected to downslope areas and can contribute to stream flow. Under the appropriate catchment saturation deficit conditions, these are sites of disconnected, non-contributing saturated areas. When non-zero DUL cells are initially saturated, their precipitation excess will contribute to downslope re-infiltation, lessening the catchment's overall saturation deficit, rather than contributing to stormflow.</p> </blockquote> <p><img alt="" src="./img/HydrologicConnectivity_DUL.webp" /></p> <blockquote> <p>The UDSA (see image below) is defined for a grid cell as <strong>the number of upslope cells with a WI value higher than the current cell</strong>. Areas with non-zero UDSA are likely to have saturation deficits that are at least partly satisfied by local re-infiltation of overland flow from upslope areas. These non-zero UDSA cells are key sites causing the hydrologic disconnectivity of the catchment during certain conditions.</p> </blockquote> <p><img alt="" src="./img/HydrologicConnectivity_UDSA.webp" /></p> <p>In the original Lane et al. (2004) NI paper, the authors state that the calculation of the index requires a unique, single downslope flow path for each grid cell. Therefore, the authors used the D8 single-direction flow algorithm to calculate NI. While the D8 method works well to model flow in convergent and channelized areas, it is generally recognized as a poor method for estimating WI on hillslopes, where divergent, non-chanellized flow dominates. Furthermore, the use of the D8 algorithm implied that the only way that WI can decrease downslope is for slope gradient to decrease, since specific contributing area only increases downslope with the D8 method. However, theoretically, WI may also decrease downslope due to flow dispersion, which allows for the upslope area (a surrogate for discharge) to be spread over a larger downslope dispersal area. The original NI formulation could not account for this effect.</p> <p>Thus, in the implementation of the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#hydrologic_connectivity">hydrologic_connectivity</a> tool, WI is first calculated using the multiple flow-direction (MFD) algorithm described by Quinn et al. (1995), which is commonly used to estimate WI. While this implies that there are a multitude of potential flow pathways connecting each grid cell to a downstream location, in reality, if the flow path that follows the path of maximum WI issuing from a cell experiences a reduction in WI (to the point where it becomes less than the issuing cell's WI), then we can safely assume that re-infiltration occurs and the issuing cell is at times disconnected from downslope sites. Thus, after WI has been estimated using the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#quinn_flow_accumulation">quinn_flow_accumulation</a> algorithm, flow directions, which are used to calculate upslope and downslope flow paths for calculating the two indices, are approximated by identifying the downslope neighbour of highest WI value for each grid cell.</p> <p><strong>Operation</strong></p> <p>The user must specify the name of the input digital elevation model (DEM; <code>dem</code>), and the output DUL and UDSA rasters (<code>output1</code> and <code>output2</code>). The DEM must have been hydrologically corrected to remove all spurious depressions and flat areas. DEM pre-processing is usually achived using either the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#breach_depressions_least_cost">breach_depressions_least_cost</a> (also <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#breach_depressions_least_cost">breach_depressions_least_cost</a>) or <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#fill_depressions">fill_depressions</a> tool. The remaining two parameters are associated with the calculation of the Quinn et al. (1995) flow accumulation (<a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#quinn_flow_accumulation">quinn_flow_accumulation</a>), used to estimate WI. A value must be specified for the exponent parameter (<code>exponent</code>), a number that controls the degree of dispersion in the flow-accumulation grid. A lower value yields greater apparent flow dispersion across divergent hillslopes. The exponent value (<em>h</em>) should probably be less than 10.0 and values between 1 and 2 are most common. The following equations are used to calculate the portion flow (<em>F<sub>i</sub></em>) given to each neighbour, <em>i</em>:</p> <blockquote> <p><em>F<sub>i</sub></em> = <em>L<sub>i</sub></em>(tan&beta;)<sup><em>p</em></sup> / &Sigma;<sub><em>i</em>=1</sub><sup><em>n</em></sup>[<em>L<sub>i</sub></em>(tan&beta;)<sup><em>p</em></sup>]</p> <p><em>p</em> = (<em>A</em> / <em>threshold</em> + 1)<sup><em>h</em></sup></p> </blockquote> <p>Where <em>L<sub>i</sub></em> is the contour length, and is 0.5&times;grid size for cardinal directions and 0.354&times;grid size for diagonal directions, <em>n</em> = 8, and represents each of the eight neighbouring grid cells, and, <em>A</em> is the flow accumultation value assigned to the current grid cell, that is being apportioned downslope. The non-dispersive, channel initiation <em>threshold</em> (<code>threshold</code>) is a flow-accumulation value (measured in upslope grid cells, which is directly proportional to area) above which flow dispersion is no longer permited. Grid cells with flow-accumulation values above this threshold will have their flow routed in a manner that is similar to the D8 single-flow-direction algorithm, directing all flow towards the steepest downslope neighbour. This is usually done under the assumption that flow dispersion, whilst appropriate on hillslope areas, is not realistic once flow becomes channelized. Importantly, the <code>threshold</code> parameter sets the spatial extent of the stream network, with lower values resulting in more extensive networks.</p> <h2>References</h2> <p>Beven K.J., Kirkby M.J., 1979. A physically-based, variable contributing area model of basin hydrology. <em>Hydrological Sciences Bulletin</em> 24: 43–69.</p> <p>Lane, S.N., Brookes, C.J., Kirkby, M.J. and Holden, J., 2004. A network‐index‐based version of TOPMODEL for use with high‐resolution digital topographic data. <em>Hydrological processes</em>, 18(1), pp.191-201.</p> <p>Quinn, P. F., K. J. Beven, Lamb, R. 1995. The in (a/tanβ) index: How to calculate it and how to use it within the topmodel framework. <em>Hydrological processes</em> 9(2): 161-182.</p> <h2>See Also</h2> <p><a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#wetness_index">wetness_index</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#quinn_flow_accumulation">quinn_flow_accumulation</a></p>
<h2>Project Links</h2>
<div align="left">
    <a href="https://www.whiteboxgeo.com/whitebox-workflows-for-python/">WbW Homepage</a>
    <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/preface.html">User Manual</a>
    <a href="https://www.whiteboxgeo.com/wbw-purchase/">Support WbW</a>
</div>        
