<h2>License Information</h2> <p>Use of this function requires a license for Whitebox Workflows for Python Professional (WbW-Pro). Please visit <a href="https://www.whiteboxgeo.com/">www.whiteboxgeo.com</a> to purchase a license.</p> <p>This tool calculates the spatial pattern of average distance to the horizon based  on an input digital elevation model (DEM). As such, the index is a measure of landscape visibility. In the image below, lighter areas have a longer average distance to the horizon, measured in map units.</p> <p><img alt="" src="./img/avgerage_horizon_distance.png" /></p> <p>The user must specify an input DEM (<code>dem</code>), the azimuth fraction (<code>az_fraction</code>), the maximum search distance (<code>max_dist</code>), and the height offset of the observer (<code>observer_hgt_offset</code>). The input DEM  should usually be a digital surface model (DSM) that contains significant off-terrain objects. Such a  model, for example, could be created using the first-return points of a LiDAR data set, or using the  <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_digital_surface_model">lidar_digital_surface_model</a> tool. The azimuth  fraction should be an even divisor of 360-degrees and must be between 1-45 degrees. </p> <p>The tool operates by calculating horizon angle (see <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#horizon_angle">horizon_angle</a>)  rasters from the DSM based on the user-specified azimuth fraction (<code>az_fraction</code>). For example, if an azimuth  fraction of 15-degrees is specified, horizon angle rasters would be calculated for the solar azimuths 0,  15, 30, 45... A horizon angle raster evaluates the vertical angle between each grid cell in a DSM and a  distant obstacle (e.g. a mountain ridge, building, tree, etc.) that obscures the view in a specified  direction. In calculating horizon angle, the user must specify the maximum search distance (<code>max_dist</code>),  in map units, beyond which the query for higher, more distant objects will cease. This parameter strongly impacts the performance of the function, with larger values resulting in significantly longer processing-times. </p> <p>The <code>observer_hgt_offset</code> parameter can be used to add an increment to the source cell's elevation. For example, the following image shows the spatial pattern derived from a LiDAR DSM using <code>observer_hgt_offset = 0.0</code>:</p> <p><img alt="" src="./img/average_horizon_distance_grd_level.png" /></p> <p>Notice that there are several places, plarticularly on the flatter rooftops, where the local noise in the LiDAR DEM, associated with the individual scan lines, has resulted in a noisy pattern in the output. By adding a small height offset of the scale of this noise variation (0.15 m), we see that most of this noisy pattern is removed in the output below:</p> <p><img alt="" src="./img/average_horizon_distance_10cm.png" /></p> <p>This feature makes the function more robust against DEM noise. As another example of the usefulness of this additional parameter, in the image below, the <code>observer_hgt_offset</code> parameter has been used to  measure the pattern of the index at a typical human height (1.7 m):</p> <p><img alt="" src="./img/average_horizon_distance_170cm.png" /></p> <p>Notice how at this height the average horizon distance becomes much farther on some of the flat rooftops  where a guard wall prevents further viewing areas at shorter observer heights.</p> <blockquote> <p>The output of this function is similar to the Average View Distance provided by the Sky View tool in Saga GIS. However, for a given maximum search distance, the Whitebox tool is likely faster to compute and has the added advantage of offering the observer's height parameter, as described above.</p> </blockquote> <h2>See Also</h2> <p><a href="tool_help_wbwpro.md#sky_view_factor">sky_view_factor</a>, <a href="tool_help_wbwpro.md#horizon_area">horizon_area</a>, <a href="tool_help_wbwpro.md#openness">openness</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_digital_surface_model">lidar_digital_surface_model</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#horizon_angle">horizon_angle</a></p> <h2>Function Signature</h2> <p><code>def average_horizon_distance(self, dem: Raster, az_fraction: float = 5.0, max_dist: float = float('inf'), observer_hgt_offset: float = 0.0) -&gt; Raster: ... </code></p>
<h2>Project Links</h2>
<div align="left">
    <a href="https://www.whiteboxgeo.com/whitebox-workflows-for-python/">WbW Homepage</a>
    <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/preface.html">User Manual</a>
    <a href="https://www.whiteboxgeo.com/wbw-purchase/">Support WbW</a>
</div>        
