<h2>License Information</h2> <p>Use of this function requires a license for Whitebox Workflows for Python Professional (WbW-Pro). Please visit <a href="https://www.whiteboxgeo.com/">www.whiteboxgeo.com</a> to purchase a license.</p> <h2>Description</h2> <p>The FilterLidar tool is a very powerful tool for filtering points within a LiDAR point cloud based on point properties. Complex filter statements (<code>statement</code>) can be used to include or exclude points in the output file (<code>output</code>).</p> <p>Note that if the user does not specify the optional input LiDAR file (<code>input</code>), the tool will search for all valid LiDAR (<em>.las, </em>.laz, *.zlidar) files contained within the current working directory. This feature can be useful for processing a large number of LiDAR files in batch mode. When this batch mode is applied, the output file names will be the same as the input file names but with a '_filtered' suffix added to the end.</p> <p>Points are either included or excluded from the output file by creating conditional filter statements. Statements must be valid Rust syntax and evaluate to a Boolean. Any of the following variables are acceptable within the filter statement:</p> <table> <th><td>Variable Name</td><td>Description</td></th> <tr><td>x</td><td>The point x coordinate</td></tr> <tr><td>y</td><td>The point y coordinate</td></tr> <tr><td>z</td><td>The point z coordinate</td></tr> <tr><td>intensity</td><td>The point intensity value</td></tr> <tr><td>ret</td><td>The point return number</td></tr> <tr><td>nret</td><td>The point number of returns</td></tr> <tr><td>is_only</td><td>True if the point is an only return (i.e. ret == nret == 1), otherwise false</td></tr> <tr><td>is_multiple</td><td>True if the point is a multiple return (i.e. nret > 1), otherwise false</td></tr> <tr><td>is_early</td><td>True if the point is an early return (i.e. ret == 1), otherwise false</td></tr> <tr><td>is_intermediate</td><td>True if the point is an intermediate return (i.e. ret > 1 && ret < nret), otherwise false</td></tr> <tr><td>is_late</td><td>True if the point is a late return (i.e. ret == nret), otherwise false</td></tr> <tr><td>is_first</td><td>True if the point is a first return (i.e. ret == 1 && nret > 1), otherwise false</td></tr> <tr><td>is_last</td><td>True if the point is a last return (i.e. ret == nret && nret > 1), otherwise false</td></tr> <tr><td>class</td><td>The class value in numeric form, e.g. 0 = Never classified, 1 = Unclassified, 2 = Ground, etc.</td></tr> <tr><td>is_noise</td><td>True if the point is classified noise (i.e. class == 7</td><td>class == 18), otherwise false</td></tr> <tr><td>is_synthetic</td><td>True if the point is synthetic, otherwise false</td></tr> <tr><td>is_keypoint</td><td>True if the point is a keypoint, otherwise false</td></tr> <tr><td>is_withheld</td><td>True if the point is withheld, otherwise false</td></tr> <tr><td>is_overlap</td><td>True if the point is an overlap point, otherwise false</td></tr> <tr><td>scan_angle</td><td>The point scan angle</td></tr> <tr><td>scan_direction</td><td>True if the scanner is moving from the left towards the right, otherwise false</td></tr> <tr><td>is_flightline_edge</td><td>True if the point is situated along the filightline edge, otherwise false</td></tr> <tr><td>user_data</td><td>The point user data</td></tr> <tr><td>point_source_id</td><td>The point source ID</td></tr> <tr><td>scanner_channel</td><td>The point scanner channel</td></tr> <tr><td>time</td><td>The point GPS time, if it exists, otherwise 0</td></tr> <tr><td>red</td><td>The point red value, if it exists, otherwise 0</td></tr> <tr><td>green</td><td>The point green value, if it exists, otherwise 0</td></tr> <tr><td>blue</td><td>The point blue value, if it exists, otherwise 0</td></tr> <tr><td>nir</td><td>The point near infrared value, if it exists, otherwise 0</td></tr> <tr><td>pt_num</td><td>The point number within the input file</td></tr> <tr><td>n_pts</td><td>The number of points within the file</td></tr> <tr><td>min_x</td><td>The file minimum x value</td></tr> <tr><td>mid_x</td><td>The file mid-point x value</td></tr> <tr><td>max_x</td><td>The file maximum x value</td></tr> <tr><td>min_y</td><td>The file minimum y value</td></tr> <tr><td>mid_y</td><td>The file mid-point y value</td></tr> <tr><td>max_y</td><td>The file maximum y value</td></tr> <tr><td>min_z</td><td>The file minimum z value</td></tr> <tr><td>mid_z</td><td>The file mid-point z value</td></tr> <tr><td>max_z</td><td>The file maximum z value</td></tr> <tr><td>dist_to_pt</td><td>The distance from the point to a specified xy or xyz point, e.g. dist_to_pt(562500, 4819500) or dist_to_pt(562500, 4819500, 320)</td></tr> <tr><td>dist_to_line</td><td>The distance from the point to the line passing through two xy points, e.g. dist_to_line(562600, 4819500, 562750, 4819750)</td></tr> <tr><td>dist_to_line_seg</td><td>The distance from the point to the line segment defined by two xy end-points, e.g. dist_to_line_seg(562600, 4819500, 562750, 4819750)</td></tr> <tr><td>within_rect</td><td>1 if the point falls within the bounds of a 2D or 3D rectangle, otherwise 0. Bounds are defined as within_rect(ULX, ULY, LRX, LRY) or within_rect(ULX, ULY, ULZ, LRX, LRY, LRZ)</td></tr>  </table> <p>In addition to the point properties defined above, if the user applies the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_eigenvalue_features">lidar_eigenvalue_features</a> tool on the input LiDAR file, the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#filter_lidar">filter_lidar</a> tool will automatically read in the additional *.eigen file, which include the eigenvalue-based point neighbourhood measures, such as <code>lambda1</code>, <code>lambda2</code>, <code>lambda3</code>, <code>linearity</code>, <code>planarity</code>, <code>sphericity</code>, <code>omnivariance</code>, <code>eigentropy</code>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#slope">slope</a>, and <code>residual</code>. See the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_eigenvalue_features">lidar_eigenvalue_features</a> documentation for details on each of these metrics describing the structure and distribution of points within the neighbourhood surrounding each point in the LiDAR file.</p> <p>Statements can be as simple or complex as desired. For example, to filter out all points that are classified noise (i.e. class numbers 7 or 18):</p> <p><code>!is_noise </code> The following is a statement to retain only the late returns from the input file (i.e. both last and single returns):</p> <p><code>ret == nret </code> Notice that equality uses the <code>==</code> symbol an inequality uses the <code>!=</code> symbol. As an equivalent to the above statement, we could have used the <code>is_late</code> point property:</p> <p><code>is_late </code> If we want to remove all points outside of a range of xy values:</p> <p><code>x &gt;= 562000 &amp;&amp; x &lt;= 562500 &amp;&amp; y &gt;= 4819000 &amp;&amp; y &lt;= 4819500 </code> Notice how we can combine multiple constraints using the <code>&amp;&amp;</code> (logical AND) and <code>||</code> (logical OR) operators. As an alternative to the above statement, we could have used the <code>within_rect</code> function:</p> <p><code>within_rect(562000, 4819500, 562500, 4819000) </code> If we want instead to exclude all of the points within this defined region, rather than to retain them, we simply use the <code>!</code> (logial NOT):</p> <p><code>!(x &gt;= 562000 &amp;&amp; x &lt;= 562500 &amp;&amp; y &gt;= 4819000 &amp;&amp; y &lt;= 4819500) </code> or, simply:</p> <p><code>!within_rect(562000, 4819500, 562500, 4819000) </code> If we need to find all of the ground points within 150 m of (562000, 4819500), we could use:</p> <p><code>class == 2 &amp;&amp; dist_to_pt(562000, 4819500) &lt;= 150.0 </code> The following statement outputs all non-vegetation classed points in the upper-right quadrant:</p> <p><code>!(class == 3 &amp;&amp; class != 4 &amp;&amp; class != 5) &amp;&amp; x &lt; min_x + (max_x - min_x) / 2.0 &amp;&amp; y &gt; max_y - (max_y - min_y) / 2.0 </code> As demonstrated above, the <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#filter_lidar">filter_lidar</a> tool provides an extremely flexible, powerful, and easy means for retaining and removing points from point clouds based on any of the common LiDAR point attributes.</p> <h2>See Also</h2> <p><a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#filter_lidar_classes">filter_lidar_classes</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#filter_lidar_scan_angles">filter_lidar_scan_angles</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#modify_lidar">modify_lidar</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#erase_polygon_from_lidar">erase_polygon_from_lidar</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#clip_lidar_to_polygon">clip_lidar_to_polygon</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#sort_lidar">sort_lidar</a>, <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/tool_help.html#lidar_eigenvalue_features">lidar_eigenvalue_features</a></p>
<h2>Project Links</h2>
<div align="left">
    <a href="https://www.whiteboxgeo.com/whitebox-workflows-for-python/">WbW Homepage</a>
    <a href="https://www.whiteboxgeo.com/manual/wbw-user-manual/book/preface.html">User Manual</a>
    <a href="https://www.whiteboxgeo.com/wbw-purchase/">Support WbW</a>
</div>        
